"use strict";function Start(bd){M.start(bd);da(M.bz);$("#stock").on("click",cj);$(L.src).on(L.evt,".card:last-child",cc);$("#game, #again").on("click",cx);$("#hint").on("click",cb);$("#undo").on("click",de);$("#tool, #list").on("click",cv);$("body").on("contextmenu",cg);$(document).on("keyup",function(n){n.which===113?cx():n.which===72?cb():n.which===90?n.ctrlKey&&de():(n.which===13||n.which===32)&&M.cq()&&cx()}).on("keydown",function(n){n.which===32&&n.preventDefault()});cl()}function cg(n,t){var i,bi;if(n.preventDefault(),!M.bj||t)return(dr(),i=M.bb(),M.bj=i!==null,!M.bj)?(ch(!0),!1):(bi=M.co(i.aa,i.az,i.ae.id),cn(bi,function(){cg(n,!0)}),!1)}function ch(n){if(L.dad!==""){if(!n){try{try{$(".ui-draggable").draggable("destroy")}catch(i){}try{$(".drop").droppable("destroy")}catch(i){}}catch(r){}$("body").css("cursor","auto");return}var t={containment:"#solitaire",cursor:"move",revert:!0,opacity:1.7,revertDuration:"fast",helper:function(n){var t=$(n.target),af=t.nextAll().addBack(),i=$("<div/>").append(af.clone()).css("margin-top",t.css("margin-top")).css("margin-left",t.css("margin-left"));return af.addClass("hide"),i},start:function(n,t){t.helper.css("z-index",1);var i={hoverClass:"hovered",tolerance:L.mod,drop:function(n,t){ck(n,t.draggable[0].id)}};$(".drop").droppable(i)},stop:function(n,t){t.helper.css("z-index",0);$(".card").removeClass("hide")}};$(L.dad).draggable(t)}}function cj(){M.bj||(M.bv(),cn(null),cl())}function ck(n,aa){var az,bi,t;M.bj||(az=$("#"+aa).parent().attr("id"),bi=M.co(aa,az,n.target.id),cw(bi),M.bh&&(t=M.ce(az),t.ac()||setTimeout(function(){cg(n)},5)))}function cl(){$(".dialog").hide();M.bj||ch(!0);dz();var cq=M.cq();cq!==0&&($("#win h3").hide(),cq>0&&$("#win .win").show(),cq<0&&$("#win .lost").show(),$("#win").show(),$("#overlay").show(),setTimeout(function(){$("#overlay").hide()},1e3))}function cm(co){var n=M.ce(co.az);da([n]);da([co.ae])}function cw(bi){if(bi.length!==0){ch(!1);for(var n=0;n<bi.length;n++)cm(bi[n]);cl()}}function cx(){var n,t,i;if(!M.bj){while(K.length>0)clearTimeout(K.pop());n=M.bf[1];t=M.bf[0];M.count<(n?1:10)?(M.start(),da(M.bz),cl()):i=n?location=t(n):location.reload()}}function cc(n){if(!M.bj){var aa=n.target.id,az=$("#"+aa).parent().attr("id"),bi=M.co(aa,az,L.dst);cn(bi,M.bh?function(){cg(n)}:null)}}function cv(){M.bj||(window.scrollTo(0,0),$(".dialog").hide(),$("#run").show())}function cb(){var bq;if(!M.bj){for(dr();K.length>0;)clearTimeout(K.pop());if($(".hint").removeClass("hint"),$("#zombie").remove(),bq=M.ca(),bq!==null){var i=500,t=1500,aa=bq.aa,n=bq.ae;n.id==="stock"?(i-=500,t-=500):$("#"+aa).addClass("hint");n.id==="waste"?t-=500:n.ax()?$("#"+n.id).append("<div id='zombie' class='card hint space'>"):(aa=n.al().ap,K.push(setTimeout(function(){$("#"+aa).addClass("hint")},i)));K.push(setTimeout(function(){$(".hint").removeClass("hint");$("#zombie").remove()},t))}}}function da(bz){for(var i,t,ar,n=0;n<bz.length;n++)bz[n]!==null&&($("#"+bz[n].id+" .card").remove(),$("#"+bz[n].id).append(bz[n].ad()));for($(".drag").removeClass("drag"),i=M.bc(),t=0;t<i.length;t++)$("#"+i[t]).addClass("drag");M.bm!==null&&(ar=M.bm===9?"10":I[M.bm][0],$(".drop .write div").text(ar))}function dz(){var t=M.bx()?"+":"Ã—",n;$("#stock .write div").text(t);n=M.br.af.length;M.id==="AcesUp"&&(n/=4);n<6&&n>0&&$(".count .card:last-child").html("<div>"+n.toString()+"<\/div>")}function de(){M.bj||M.bo||cn(M.cf(),function(){M.bo=!1})}function dr(){M.bl!==null&&(M.bl.ae.al().ao=!1,da([M.bl.ae]),M.bl=null)}function cn(bi,n){var r,u,t;if(!M.bg){bi===null?da(M.bz):cw(bi);n&&n();return}if(bi===null&&(bi=M.bi.slice(-2),bi[1].aa==="list")){da(M.bz);return}if(bi.length>0&&bi[0].ae===null&&bi.shift(),bi.length!==0){var e=$("#"+bi[0].aa),f=e.offset(),i=bi[0].ae;$("#"+i.id).append("<div id='target' class='card hint space'>");r=$("#target");u=r.offset();r.remove();var o=u.left-f.left,s=u.top-f.top,ah=i.am(bi[0].aa),af=i.af;for(t=ah;t<af.length;t++)$("#"+af[t].ap).css("z-index",100+t).css("transition","all 200ms ease-in-out").css("transform","translate("+o+"px, "+s+"px)");setTimeout(function(){cw(bi);n&&n()},205)}}var J=["Hearts","Spades","Diamonds","Clubs"],I=["Ace","2","3","4","5","6","7","8","9","10","Jack","Queen","King"],E=0,F=1,G=2,H=3,D=function(){function D(aa,az,ae){this.aa=aa;this.az=az;this.ae=ae}return D}(),A=function(){function A(n){this.id=n;this.ar=n%13;this.at=Math.floor(n/13);this.ay=this.at===E||this.at===G;this.au=!this.ay;this.ai=!1;this.ao=!1;this.ap=J[this.at][0]+(this.ar===9?"T":I[this.ar][0]);this.html="<div id='"+this.ap+"' class='card down'><\/div>"}return A.prototype.aq=function(){return this.ar===0},A.prototype.as=function(){return this.ar===12},A.prototype.ad=function(){var n=this.html;return this.ao&&(n=n.replace(" down"," down selected")),this.ai&&(n=n.replace(" down"," up")),n},A.prototype.toString=function(){return I[this.ar]+" "+J[this.at]},A}(),B=function(){function B(){this.af=[];for(var n=0;n<52;n++)this.af[n]=new A(n);for(n=0;n<this.af.length;n++)this.af[n]=this.af.splice(Math.floor(this.af.length*Math.random()),1,this.af[n])[0]}return B.prototype.ag=function(n){return n>this.af.length&&(n=this.af.length),this.af.splice(0,n)},B}(),C=function(){function C(ah,n){this.ah=ah;this.af=[];this.id=n;this.aj=-1}return C.prototype.al=function(){return this.af[this.af.length-1]},C.prototype.am=function(aa){for(var n=0;n<this.af.length;n++)if(this.af[n].ap===aa)return n;return-1},C.prototype.aw=function(){for(var n=0;n<this.af.length;n++)if(this.af[n].ai)return n;return-1},C.prototype.ax=function(){return this.af.length===0},C.prototype.ac=function(){return this.id[0]==="f"},C.prototype.av=function(){return this.id[0]==="r"},C.prototype.ab=function(){return this.id[0]==="s"},C.prototype.an=function(){return this.id[0]==="t"},C.prototype.ba=function(){return this.id[0]==="w"},C.prototype.ad=function(){var r="",i=this.aj,n,t;for(i<0&&(i=this.af.length),n=this.af.length-i,n<0&&(n=0),t=n;t<this.af.length;t++)r+=this.af[t].ad();return r},C.prototype.toString=function(){return this.id},C}(),V=function(){function V(){this.bz=[];this.be=[];this.br=null;this.bt=null;this.by=[];this.bu=[];this.bi=[];this.bo=!1;this.bp=null;this.bq=-1;this.bs=!0;this.id="Pyramid";this.bd=1;this.bf=["",""];this.bg=!1;this.bh=!1;this.bj=!1;this.count=0;this.bk=!0;this.bl=null;this.bm=null;this.countRedraw=0;this.maxRedraw=1e4;try{this.bf=[atob,null]}catch(n){}}return V.prototype.bw=function(){var n,t,r,u,aa,i,s,e,af,h,f,c,o;for(this.bp=[],this.bq=-1,i=this.cz(),s=i.length,n=0;n<s;n++)for(aa=i[n].al().ap,t=0;t<this.bu.length;t++)if(this.cu(aa,i[n].id,this.bu[t].id)){this.bp.push(new D(aa,i[n].id,this.bu[t]));break}for(e=[],n=0;n<s;n++)for(af=this.bn(i[n]),r=0;r<af.length;r++)for(h=af[r].as()&&r===0&&i[n].an(),aa=af[r].ap,t=0;t<this.by.length;t++)if(this.cu(aa,i[n].id,this.by[t].id)){if(f=!0,h&&this.by[t].an()&&(f=!1),f)for(u=0;u<this.bp.length;u++)if(this.bp[u].az===this.by[t].id&&this.bp[u].ae.id===i[n].id){f=!1;break}f&&(r===0?this.bp.push(new D(aa,i[n].id,this.by[t])):e.push(new D(aa,i[n].id,this.by[t])))}e.length>0&&(this.bp=this.bp.concat(e));this.bp.length===0&&this.bx()&&this.bp.push(new D("draw",this.br.id,this.br));this.bf[1]===null&&(c="aHR0cHM6Ly93d3cuc2",o=""+location,this.bf[1]=o.indexOf("alh")>0||o.indexOf("e-p")>0||o.indexOf("f")===0?"":c+"9saXRhaXJlLXBsYXkuY29t");this.bs=this.bp.length!==0;this.id==="FreeCell"&&this.be.reduce(function(n,t){return n+t.af.length},0)<4&&(this.bs=!0)},V.prototype.bx=function(){return this.id==="Cruel"||this.id==="MonteCarlo"?!this.bk:this.br&&this.br.af.length>0?!0:this.countRedraw>=this.maxRedraw?!1:this.bt&&this.bt.af.length>0?!0:!1},V.prototype.ag=function(){var t=function(ah){var n=null;switch(ah){case 31:break;case 28:n="waste";break;case 29:n="stock";break;case 30:n="f0";break;default:n="t"+ah.toString()}return n},n;for(this.cp(t),n=0;n<28;n++)this.br.af[n].ai=!0;for(n=0;n<this.by.length;n++)this.by[n].af=this.br.af.splice(0,1)},V.prototype.bc=function(){return[]},V.prototype.bv=function(){if(this.br.id!==""){if(this.br.ax()){if(!(this.countRedraw>=this.maxRedraw)&&this.bt&&!this.bt.ax()){for(this.countRedraw++,this.cs("list",null,null);!this.bt.ax();)this.cd(this.bt,this.br);this.cs("list",null,null)}}else{this.bd!==1&&this.cs("list",null,null);for(var n=0;n<this.bd;n++)this.cd(this.br,this.bt||this.bu[0]);this.bd!==1&&this.cs("list",null,null)}this.bk=!0;this.bw()}},V.prototype.bb=function(){var n,bq;for(this.bw(),n=0;n<this.bp.length;n++)if(bq=this.bp[n],bq.aa!=="draw"){if(!bq.ae.ac())if(this.id==="MonteCarlo"){if(bq.az[0]!=="t")continue}else if(this.id==="Pyramid"){if(bq.az[0]!=="t"&&bq.az[0]!=="w")continue}else continue;return bq}return null},V.prototype.bn=function(ae){var i=ae.af.length,t=i-1,r=[],n;for(this.id==="Yukon"&&(t=ae.aw()),this.id==="Australian"&&(t=0),n=t;n<i;n++)r.push(ae.af[n]);return r},V.prototype.ca=function(){return(this.bp===null&&this.bw(),!this.bs)?null:(this.bq++,this.bq===this.bp.length&&(this.bq=0),this.bp[this.bq])},V.prototype.cz=function(){var n=this.by.filter(function(n){return!n.ax()}),i=this.id==="Cruel",t;if(n.sort(function(n,t){var r=t.af.length-n.af.length;return i&&(r=t.al().ar-n.al().ar),r===0&&(r=n.ah-t.ah),r}),this.id==="Pyramid"&&this.bt.af.length>0&&n.push(this.bt),this.id==="Canfield"&&this.bt.af.length>0&&n.push(this.bt),this.id==="Canfield"&&this.be[0].af.length>0&&n.push(this.be[0]),this.id==="FreeCell")for(t=0;t<this.be.length;t++)this.be[t].ax()||n.push(this.be[t]);return this.id==="Australian"&&this.bt.af.length>0&&n.push(this.bt),n},V.prototype.ce=function(n){for(var t=0;t<this.bz.length;t++)if(this.bz[t].id===n)return this.bz[t];return null},V.prototype.cu=function(aa,az,n){var i=function(az,n,by){var ah=1*az.substring(1),t=ah;return az==="waste"?!0:ah>=21?!0:(t+=ah>=15?6:ah>=10?5:ah>=6?4:ah>=3?3:ah>=1?2:1,!by[t].ax()&&by[t].id!==n)?!1:!by[t+1].ax()&&by[t+1].id!==n?!1:!0},r,u,t;return this.bo?!0:az===n?!1:(r=this.ce(az),u=r.al(),aa!==u.ap)?!1:r.ac()?!1:r.ab()?!1:n==="?"?i(az,n,this.by):(t=this.ce(n),t.ab())?!1:u.as()&&t.ac()?i(az,"?",this.by):t.ac()?!1:t.ax()?!1:u.ar+1+(t.al().ar+1)!==13?!1:i(az,n,this.by)?i(n,az,this.by)?!0:!1:!1},V.prototype.co=function(aa,az,n){var bi=[],i=this.ce(az),t,u=!1,r;if(n!=="?"){if(!this.cu(aa,az,n))return[]}else this.bl===null?this.cu(aa,az,"f0")?n="f0":this.cu(aa,az,n)&&(i.al().ao=!0,this.bl=new D(aa,az,i),bi.push(new D(aa,az,null))):this.cu(aa,az,this.bl.az)?(n=this.bl.az,this.bl=null):(this.bl.ae.al().ao=!1,bi.push(this.bl),this.bl=null);return n==="?"?bi:(r=this.ce(n),u=i.an()&&r.an()||i.ba()&&r.an()||i.an()&&r.ba(),u?(bi.push(this.cs("list","",null)),t=r.af.pop(),t.ao=!1,this.bu[0].af.push(t),bi.push(this.cs(t.ap,r.id,this.bu[0])),t=i.af.pop(),this.bu[0].af.push(t),bi.push(this.cs(t.ap,i.id,this.bu[0])),bi.push(this.cs("list","",null))):(t=i.af.pop(),r.af.push(t),bi.push(this.cs(aa,az,r))),this.bk=!1,bi)},V.prototype.cp=function(n){for(var r=new B,i,t=0;t<99;t++){if(i=n(t),i===null)break;this.bz[t]=new C(t,i)}for(this.by=[],this.bu=[],this.be=[],t=0;t<this.bz.length;t++)switch(this.bz[t].id[0]){case"r":this.be.push(this.bz[t]);break;case"s":this.br=this.bz[t];break;case"w":this.bt=this.bz[t];this.bt.aj=3;break;case"t":this.by.push(this.bz[t]);break;case"f":this.bu.push(this.bz[t])}this.br||(this.br=new C(99,""));this.br.af=r.ag(99);this.bi=[];this.bp=null},V.prototype.start=function(bd){bd&&(this.bd=bd);for(var cq=-1;cq===-1;)this.ag(),this.bv(),cq=this.cq();this.count++},V.prototype.cq=function(){if(this.bo)return 0;var n=this.bu.reduce(function(n,t){return n+t.af.length},0);return n===52?1:n===48&&this.id==="AcesUp"?1:(n=this.by.reduce(function(n,t){return n+t.af.length},0),n===0&&this.id==="Golf")?1:n===0&&this.id==="Pyramid"?1:(this.bw(),!this.bs)?-1:0},V.prototype.cs=function(aa,az,ae){this.bp=null;var co=new D(aa,az,ae);return this.bo||this.bi.push(co),co},V.prototype.cd=function(n,t){if(!n.ax()){var i=n.af.pop();t.af.push(i);this.cs(i.ap,n.id,t);i.ai=n.ab();this.cs(i.ap,t.id,null)}},V.prototype.cf=function(){var n,t,i,r,u,bi;if(this.bi.length===0)return[];n=this.bi[this.bi.length-1];t=0;n.aa==="list"?(t=99999,n=this.bi.pop()):t=n.ae===null?2:1;i=[];this.bo=!0;do n=this.bi.pop(),n.aa==="list"?t=0:n.ae===null?(r=this.ce(n.az),u=r.am(n.aa),r.af[u].ai=!r.af[u].ai,i.push(n)):(bi=this.co(n.aa,n.ae.id,n.az),i.push(bi[0])),t--;while(t>0);return i},V}(),M=new V,K=[],L={evt:"click",src:".drop",dst:"?",dad:"",mod:""}